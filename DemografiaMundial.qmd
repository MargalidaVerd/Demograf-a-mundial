---
title: "Demografía Mundial"
author: "Carla Martínez, Patricia Mateu y Margalida Verd"
format: html
editor: visual
---

## Introducción

analisis a nivel continental desde el 2018 al 2020
ver si hay diferencias significativas por continentes
en cada continente analizar los paises que más difieren del resto
ver si en el 2020 han habido cambios significativos 
ver si en los paises con más diferencias en mortalidad de un año al otro vienen dados por un evento significativo
ver si la paz afecta en la esperanza de vida y en la natalidad ejemplo Dinamarca



El objetivo de nuestro proyecto consiste en analizar los datos demográficos de los países del mundo a nivel continental 

## Carga de datos y limpieza

Empezamos con la carga de los dataframes que usaremos y veamos la estructura del nuevo tibble.

```{r, warning=FALSE,message=FALSE}
library(tidyverse)

# Cargamos el primer dataframe
global_population = read_csv("Global Population Trends(2016-2022).csv", show_col_types = FALSE) 

# Del segundo dataframe seleccionamos las variables que nos interesan para el estudio

data = read_csv("world_population.csv",show_col_types = FALSE)
world_data <- data %>% 
  select(3,5,14) %>% rename(Country= "Country/Territory", Area_km2 = "Area (km²)")   
# Unimos los dos dataframes y creamos el tibble que usaremos para el estudio
world_population = left_join(global_population,world_data, by = "Country")

world_population %>% 
  glimpse()

```

Ahora, procedemos con la limpieza; para empezar, renombramos las columnas con la función `rename()`, ya que sus nombres estaban en inglés, y cambiamos la posición de algunas variables con la función `relocate()`, para que las variables sigan un orden lógico.

```{r, warning=FALSE, message=FALSE}
world_population <- world_population %>% 
  rename(Pais = "Country", 
         Año = "Year", 
         Pob_total = "Total Population", 
         Pob_urbana = "Urban Population", 
         Pob_rural = "Rural Population", 
         Densidad = "Population Density", 
         Esp_vida = "Life Expectancy", 
         Natalidad = "Birth Rate", 
         Mortalidad = "Death Rate", 
         Fertilidad = "Fertility Rate", 
         Mortalidad_infantil = "Infant Mortality Rate", 
         Crecimiento = "Growth Rate", 
         Continente = "Continent") %>% 
  relocate(Continente, .after = Pais) %>% 
  relocate(Area_km2, .after = Continente) %>% 
  relocate(Mortalidad_infantil, .after = Mortalidad) 

```

Además, cambiaremos el tipo de algunas variables ya que queremos que se ajusten a las necesidades del estudio. Para ello, utilizamos la función `mutate()`.

```{r, warning=FALSE, message=FALSE}
world_population <- world_population %>% 
  mutate(Año = as.character(Año)) %>% 
  mutate(Pob_total = as.numeric(gsub("," , "", Pob_total, fixed = TRUE))) %>%
  mutate(Pob_rural = as.numeric(gsub("," , "", Pob_rural, fixed = TRUE))) %>%
  mutate(Pob_urbana = as.numeric(gsub("," , "", Pob_urbana, fixed = TRUE))) %>% 
  mutate(Densidad = as.integer(Densidad)) %>% 
  mutate(Esp_vida = as.integer(Esp_vida)) %>% 
  mutate(Fertilidad = as.numeric(Fertilidad)) %>% 
  mutate(Mortalidad_infantil = as.numeric(Mortalidad_infantil)) %>% 
  mutate(Crecimiento = as.integer(Crecimiento))
  
```

Visualicemos el conjunto de datos que presentan algún valor NA.

```{r}
world_population %>% 
  group_by(Año) %>% 
  summarise_all(funs(sum(is.na(.))))

```

Como vemos, tenemos bastantes datos faltantes en los años 2017 y 2021; por eso, reduciremos nuestro estudio entre los años 2018 y 2020. Utilizaremos la función `filter()` para eliminarlo de nuestro tibble.


```{r,warning=FALSE,message=FALSE}
world_population <- world_population %>% 
  filter(Año == 2018 |Año == 2019 |Año == 2020 ) 
```

Visualizamos la estructura del dataframe resultante de la limpieza:

```{r}
world_population <- world_population %>%
  glimpse()
```
Ahora, trataremos particularmente los datos NA de las variables *Contiente* y *Area_km2*, ya que son las variables que hemos añadido de otro dataframe. En este caso, rellenaremos manualmente estos datos. La información con la que hemos completado estos valores se han sacado de: ??????????????

```{r}

world_population %>% 
  filter(., is.na(Continente))

````
```{r}
world_population %>% 
  replace_na(replace = list("North America",))
```

Anty Barb: NA, 440,29
Bosnia: Europa, 51197
cabo Verde: africa, 4033
Channel islands: europa, 198
democratic republic congo: africa, 2344858
isle of man: europa, 572
kosovo: europa, 10887
kyrgyz: asia, 199951
lao pdr: asia, 236800
macao: asia, 28.2
congo: africa, 342000
sao tome and principe: africa, 964
slovak republic: europa, 49035
saint marteen (parte alemana): europa, 34
st kitts and nevis: north america, 269
sta lucia: sud america, 616
st marteen (parte francesa): europa, 53.2
st. Vincent And The Grenadines: north america, 389
syria: asia, 185180
Trinidad And Tobago: sud america, 5128
Turks And Caicos Islands: noth america, 948
UAE: asia, 83600
Virgin Islands (U.S.): north america, 346.36
West Bank And Gaza: asia, 5860


## Análisis multivariante exploratorio

<<<<<<< HEAD
=======
```{r}
world_population %>% 
  summarise(., group_by(Año))

```

>>>>>>> c673026bd90803ca37435517c7a6e64160091089
## Estimación y correlaciones

## Conclusiones


