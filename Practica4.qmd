---
title: "Práctica 4"
author: "Carla Martínez, Patricia Mateu y Margalida Verd"
format: html
editor: visual
---
## Ejercicio 4:
```{r, warning=FALSE, echo=FALSE}
library(mvtnorm)
library(ggplot2)
```

Vamos a crear una muestra aleatoria de tamaño $N$ de una $T^2$ con parámetros $p$ y $n$ grados de libertad. Para ello, crearemos una muestra aleatoria de una F de Fisher y usaremos la siguiente propiedad:

$$ T^2(p,n) = \frac{np}{n-p+1}F_{n-p+1}^p$$

```{r,message=FALSE}
N = 100
n = 100
p = 15
set.seed(61123) #fecha del día
vector_fisher = rf(N,n-p+1,p)
x = (n*p*vector_fisher)/(n-p+1)
df <- data.frame(x)
ggplot(df, aes(x = x)) + 
  geom_histogram(aes(y = ..density..),
                 colour = 1, fill = "lightblue") +
  geom_density(lwd = 0.75,
               color = "blue") +
  xlab("x") +
  ylab("")

```

```{r,message=FALSE}
N = 1000
n = 100
p = 15
set.seed(61123)

vector_fisher = rf(N,n-p+1,p)
x = (n*p*vector_fisher)/(n-p+1)
df <- data.frame(x)
ggplot(df, aes(x = x)) + 
  geom_histogram(aes(y = ..density..),
                 colour = 1, fill = "#A2CD5A") +
  geom_density(lwd = 0.75,
               color = "darkgreen") +
  xlab("x") +
  ylab("")
```

```{r,message=FALSE}
N = 1000000
n = 100
p = 15
set.seed(61123)

vector_fisher = rf(N,p,n-p+1)
x = (n*p*vector_fisher)/(n-p+1)
df <- data.frame(x)
ggplot(df, aes(x = x)) + 
  geom_histogram(aes(y = ..density..),
                 colour = 1, fill = "#CD96CD") +
  geom_density(lwd = 0.75,
               color = "#551A8B") +
  xlab("x") +
  ylab("")
```
